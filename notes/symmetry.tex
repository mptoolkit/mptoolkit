\documentclass[12pt]{article}
\usepackage{fullpage}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{svg}

\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.1}

\usepackage{enumitem}
\setlist{nosep}

\input{macros}

   \newcommand{\qninejc}[9]{\mbox{$\left( \begin{array}{ccc} \!{#1}\! &
                                \!{#2}\! & \!{#3}\! \\ \!{#4}\! & \!{#5}\! &
                                \!{#6}\! \\ \!{#7}\! & \!{#8}\! & \!{#9}\! 
                                \end{array} \right)$}}

\newcommand{\ad}{\ddagger}
\newcommand{\invad}{{\ddagger \ddagger \ddagger}}

\newcommand{\fsymbol}[6]{\mbox{$\left[ F^{#1,#2,#3}_{#4} \right]_{#5,#6}$}}
\newcommand{\fsymboltt}[6]{\mbox{$\left[ F^{#1,#2}_{#3,#4} \right]_{#5,#6}$}}


\newcommand{\doi}[1]{\href{https://dx.doi.org/#1}{doi:#1}}
\newcommand{\arxiv}[1]{\href{https://arxiv.org/abs/#1}{arXiv:#1}}
\begin{document}

\title{Generalized algebras of Clebsch-Gordan, $6j$, $9j$, F-moves}

\author{I. P. McCulloch}
\date{\today}

\maketitle

\section{Introduction}

The purpose of this paper is to provide exposition and reference material for constructing
6j and 9j symbols of various algebras, and eventually to also construct projection
transformations (eg the conventional Clebsch-Gordan coefficients are associated with the
group chain $U(1) \subset SU(2)$, but we want to generalize this to other group subsets). 
This is somewhat complicated by different notation conventions; historically in $SU(2)$ theory
the Clebsch-Gordan/3j, 6j and 9j coefficients are used, which have been generalized
in similar notation to point groups (used eg in quantum chemistry). On the other hand
anyons are often described in terms of F-symbols and F-moves, of which there are two
common variants (a 3-1 move and a 2-2 move). In practical calculations, the F-symbols are
probably the most useful; these give directly the coefficients of basis transformations eg
$\fsymbol{j_1}{j_2}{j_3}{j}{j_{12}}{j_{23}} 
= \langle (j_1 j_2 j_{12}) j_3 j \vert j_1 (j_2 j_3 j_{23}) j \rangle$, 
which differs by a normalization and phase factors from a 6j symbol. However the 6j symbols
have more symmetry so are useful as an underlying implementation tool in computational
algorithms. Hence we want to find generic ways to transform beyween F-symbols and 6j symbols.

The general structure that admits a consistent set of F-symbols is known as a fusion tensor category.
It is necessary and sufficient that the F-symbols obey the Biedenharn-Elliott identity, also
known as the Pentagon relation.

The F-symbols alone are not sufficient to describe an operator algebra.  In particular, the F-symbols
do not in general give enough information to be able to determine particle statistics. For
this, we need also the braiding statistics, which is encapsulated in the symbol $R^{c}_{ab}$, which
is a coefficient (or, for non-multiplicity-free algebras, a matrix) that gives the phase change
of two charges $a$ and $b$, which fuse to particle type $c$, and we braid $b$ over the top of $a$.
For a given fusion algebra, there may be more than one possible set of braiding. The consistency
between the $R$ and $F$ symbols is given by the Hexagon relation. This gives
a braided tensor fusion category, which is ultimately the object that we are interested in.
Mathematically, we need also some other conditions, which I find to be not particularly well specified
in the literature, such as $K$-linear, semi-simplicity, existence of duals, and non-degenerate. 
Generally the literature
also looks at the \emph{finite} case (finite rank, number of charges). We are interested also in the infinite case,
which arises from semi-simple Lie agebras. I haven't seen any discussion of infinite braided tensor
categories that are \emph{not} derived from a semi-simple Lie algebra.

The classification of \emph{finite} braided tensor fusion categories is more-or-less known, up to
categories of rank ~ 5 (where the rank denotes the number of distinct charges in the category).
We can subdivide braided tensor fusion categories (BTC for short) into some syb-types,
\begin{itemize}
\item \emph{symmetric}: A symmetric braided tensor category (STC) satisfies $R^{c}_{ab} = R^{c}_{ba}$ for
all possible $a,b,c$. This implies $(R^{c}_{ab})^2 = 1$, and hence the charges behave as essentially
fermionic or bosonic character. There is a strong connection between STC and finite groups. I am not sure
if this is 1--1. For the purposes of this document, we also include infinite groups (ie, semi-simple
Lie groups) in this class. 
\item \emph{modular tensor category} (MTC): this is the `opposite' of an STC, in the sense that the
`symmetric center' of the category is trivial. 
\item \emph{integral}: if the quantum dimension of all objects is an integer, then the BTC is known as integral. 
All STC's are integral. 
\item \emph{pointed}: if the quantum dimension of all objects is unity, then the BTC is known as pointed.
STC's arising from an abelian group are pointed. But there are many examples of MTC's that are also pointed,
for example abelian anyons. There are anyon algebras that are integral but not pointed (ie, all of the quantum
dimensions are integral but there is at least one member that has dimension > 1), Bonderson gives an example
based on the fusion rules for $D_5$, but in principle any finite group could also have some non-trivial braid solutions.
\end{itemize}

The specific symmetry groups that we want to handle here are
\begin{enumerate}
\item $U(1)$
\item $SU(2)$
\item finite cyclic groups $Z_n$
\item Dihedral groups $D_n$. THere are two notations for dihedral groups, sometimes $D_{2n}$ is used.
\item Ising anyons $SU(2)_2$
\item Fibonacci anyons $SU(2)_3$
\item $SU(3)_2$ -- discussed in a nice paper by Ardonne and Slingerland\cite{Ardonne}
\end{enumerate}
Where possible we want to allow projective representations too. Such representations occur
as boundary conditions or edge particles in topological states. For the Dihedral
groups, this means allowing for half-integer quantum numbers.

\section{Literature summary}

In this section we give an overview of the primary literature that was used in the development of this document.

\begin{itemize}
\item \cite{Bonderson} A very good introdutcion to anyons in physics. Most of the diagrams and equations for $F$-symbols
are from this thesis.
\item \cite{MTC} Introduction to modular categories.
\item \cite{MTCClassification} classifies, and provides coupling coefficients, for all
modular tensor categories of rank $\leq 4$.
\item \cite{Pfeifer} Discusses in detail the effect of surface topology on the construction of fusion diagrams, in
particular how to handle boundary conditions for 1D anyon chains.
\item \cite{AnyonDMRG} DMRG for anyon chains, good discussion of normalization convention.
\end{itemize}

\section{Quantum numbers}

A quantum number is a representation of some symmetry group. Fusion of quantum
numbers is equivalent to taking products of representations, and is given by
the Clebsch-Gordan expansion,
\begin{equation}
a \otimes b \simeq \bigoplus N^{c}_{ab} \: c
\end{equation}
where $N^{c}_{ab}$ is the \emph{multiplicity} of the representation $c$ in the expansion
of $a \otimes b$.
Technically we should distinguish the representation label $j$ from the representation
matrices $D(j)$, but we won't bother with this distsinction here, unless it gives a clearer
notation.
If $N^{c}_{ab} > 1$ then a representation occurs more than once in the expansion,
and this greatly complicates the description of the coupling. This is commonly
referred to as the \emph{multiplicity problem}. Symmetry groups that always have 
$N^{c}_{ab} \leq 1$ are referred to as \emph{multiplicity free}.

Examples:
\begin{itemize}
\item $U(1)$: label the representations by a (half-)integer $j$, eg representing
the particle number or $z$-component of spin. Then the Clebsch-Gordan
expansion corresponds to simple addition of the quantum number, $D(j_1) \otimes D(j_2) = D(j_1+j_2)$.
\item $SU(2)$: The product of $SU(2)$ spins $j_1$ and $j_2$ (always non-negative) 
is a sum of $\min(2j_1+1,2j_2+1)$
representations. $N^{j}_{j_1,j_2} = 1$, if 
$j \in \{|j_1 - j_2|, |J_1 - j_2| + 1, \cdots, j_1+j_2\}$,
and $0$ otherwise.
\item Ising anyons, corresponding to $SU(2)_3$, contain spins $1$ (the identiy,
which has spin 0) and $\tau$ (analagous to a spin 1), with the
fusion rules $1 \times 1 = 1$, $1 \times \tau = \tau \times 1 = \tau$, $\tau \times \tau = 1 + \tau$.
\item $SU(3)_3 / Z_3$ is probably the simplest algebra that is \emph{not} 
multiplicity-free\cite{Ardonne}, via
\begin{equation}
8 \times 8 = 1 + 8 + 8' + 10 + \bar{10}
\end{equation}
where the representation $8$ occurs twice on the right hand side.

\end{itemize}

The `zero' quantum number always exists. This is often denoted with a 1, since it corresponds
to the trivial (identity) representation of the algebra. 
The identity quantum number is also referred to as \emph{scalar}, since it is
the unique representation that is invariant under symmetry transformations.
A representation $j$ has a conjugate or dual representation, denoted $\bar{j}$,
or in some literature as $j^*$.
\begin{itemize}
\item In $U(1)$ the conjugate correpsonds to negation, so $\bar{j} = -j$.
\item $SU(2)$ is self-dual, so $\bar{j} = j$.
\end{itemize}
The `conjugate' operation here has nothing to do with complex conjugation.  In the Matrix
Product Toolkit, the operation $\bar{j}$ is referred to as \texttt{adjoint(j)}.
Commonly, discussions of $SU(2)$ coupling coefficients omit the quantum number conjugation,
but it is still important eg for spinful particles we often have $U(1)\times SU(2)$, and
we cannot neglect the quantum number conjugation in the $U(1)$ case.

The \emph{dimension} of a representation $j$ is the dimension of the matrix $D(j)$. This
is often denoted $d_j$. For classical symmetries the dimension is an integer. For non-abelian
anyons, the dimension can be fractional and is then known as the \emph{quantum dimension}.
The dimensions satisfy the sum rule
\begin{equation}
d_{j_1} d_{j_2} = \sum_j N^{j}_{j_1,j_2} \; d_j
\end{equation}

If, for some symmetry group, all of the representations have $d_j = 1$, then the
group is abelian. This is equivalent to the statement that for each $a,b$ there is exactly
one $c$ such that $N^{c}_{ab} = 1$, and all other multiplicities are zero.

The quantum dimension $q_a$ can be obtained as the largest eigenvalue of $N^c_{ab}$, treated
as a matrix in the indices $b$, $c$. It is also possible to define the quantum dimensions through
the F-symbols (see below), as
\begin{equation}
d_a = d_{\bar{a}} = \left| [F^{a\bar{a}a}_a]_{1,1} \right|^{-1}
\end{equation}

The fusion multiplicities obey the relations
\begin{equation}
N^{c}_{ab} = N^{c}_{ba} = N^{\bar{c}}_{\bar{a}\bar{b}} = N^{\bar{a}}_{b \bar{c}}
\end{equation}
This is 12 relations in total (all permutations of $a,b,c$ plus the dual versions).
We also have
\begin{equation}
\sum_e N^{e}_{ab} N^d_{ec} = \sum_f N^d_{af} N^f_{bc}
\end{equation}
This is essentially associativity of tensor products; the number of ways of fusing
charges $a,b,c$ to a charge $d$ is the same, whether we to the fusion as
$(a\otimes b) \otimes c$ or $a \otimes (b \otimes c)$.


\section{F-symbols}

Hilbert spaces are complex spaces with an in inner product, so we need to distinguish
bra's and ket's as separate entities. In diagrammantic notation, we do this with
arrows that end at a point, either as an incoming arrow or an outgoing arrow.
It doesn't matter whether we regard an incoming arrow as a bra state
or as a ket, as long as we are globally consistent. Reversing the orientation of a line
requires conjugating the charge label, ie
\begin{equation}
\begin{gathered}
\includesvg[width=1.5cm]{labeldown}
\end{gathered}
=
\begin{gathered}
\includesvg[width=1.5cm]{labelup}
\end{gathered}
\end{equation}
In these diagrams, there is an implicit 'arrow of time', which flows from the top to the bottom,
irrespective of the direction of the arrow. Often it is convenient to use the above relation such
that the direction of 'time' and the direction of the arrows coincide. There are some subtleties
involved in bending the leg of a tensor in such a way that it points backwards, see below.

Normalization of basis vectors is important. We can choose a normalization such that some particular
operation becomes easier to express. A commonly used normalization convention
is known as `isotopy invariance', which means that the value of a diagram is invariant under continuous
deformations, as long as end points are fixed and lines are not passed through each other or around
open end points. Note however there is a subtlety that we cannot bend 
Now we want to connect our diagrams to physical states in Hilbert space.
This is a useful normalization when considering an operator point of view, because then the
matrix elements of the identity operator are 1.
This means that composing operators is very simple, we just join the corresponding lines
of the tensor diagrams and there are no additional normalization factors to consider.
However, a consequence of this is that the trace operation has a normalization factor,
$Tr a = d_a$, where $d_a$ is the dimension of the representation.
This corresponds to a common normalization convention in $SU(2)$; it is common to consider a spin $j$ as a 
'reduced ket', $\rket{j}$ which stands for a vector of $2j+1$ basis vectors (ie, a mixed state)
\begin{equation}
\rket{j} \equiv \left( \begin{array}{c} \ket{j;-j} \\ \ket{j;-j+1} \\ \vdots
\\ \ket{j;j} \end{array} \right)
\end{equation}
in which case we have $\rbraket{j}{j} = 2j+1 = d_j$. 
This is the normalization convention that us used by Bonderson \cite{Bonderson}, and we will use it
for most of these notes. However it might be computationally more convenient to use an alternative
normalization convention whereby $\rbraket{j}{j} = 1$. Ref \cite{AnyonDMRG} calls this `implicit'
normalization, and uses a mix of both conventions in numerical calculations.
The Matrix Product Toolkit uses the isotopy convention, which is certainly more natural for constructing
matrix elements. The Matrix Product Toolkit reuses the tensor arithmetic for states and operators, and
it would be a major complication to mix normalization conventions. However the implicit normalization
has some computational advantages, especially the inner product operation has \emph{no} additional
normalization factors, so as far as external algorithms are concerned we can treat anyonic states
as ordinary vectors, which simplifies interfacing to numerical algorithms. This will be discussed in more
detail later.

Tensor diagrams have some subleties which are overlooked by some authors. In particular, although
we can freely bend tensor legs to the left and right, we \emph{cannot} freely bend them up and down.
This is discussed in Bonderson \cite{Bonderson}, also by Pfeifer et al\cite{AnyonDMRG}.
In particular, the following two diagrams are \emph{not} equivaent,
\begin{equation}
\begin{gathered}
\includesvg[width=1.5cm]{labeldown}
\end{gathered}
\neq
\begin{gathered}
\includesvg[width=3cm]{twisted}
\end{gathered}
\label{eq:TwistedTime}
\end{equation}
and we will see below that they are related by a phase factor.

Fusion of two quantum numbers looks like
\begin{equation}
\begin{gathered}
\includesvg[width=1.5cm]{fusion}
\end{gathered}
\end{equation}
where we fuse two incoming states $a,b$ into an outgoing state $c$. 
Isotopy invariance means that we need a normalization factor to relate this to basis vectors,
\begin{equation}
\left(\frac{d_c}{d_a d_b} \right)^{1/4}
\begin{gathered}
\includesvg[width=1.5cm]{fusion}
\end{gathered}
= \ket{c} \bra{a}\bra{b}
\end{equation}
In alternate notation, we can express the right hand side as $\ket{a,b;c}$.

We can turn this diagram around, to represent splitting the charge $c$ into $a$ and $b$,
\begin{equation}
\left(\frac{d_c}{d_a d_b} \right)^{1/4}
\begin{gathered}
\includesvg[width=1.5cm]{splitting}
\end{gathered}
= \ket{a}\ket{b} \bra{c}
\end{equation}

Putting these together, we can form the inner product,
\begin{equation}
\begin{gathered}
\includesvg[width=1.5cm]{inner}
\end{gathered}
= \delta_{c,c'} \sqrt{\frac{d_a d_b}{d_c}}
\begin{gathered}
\includesvg[width=1.5cm]{cline}
\end{gathered}
\end{equation}
This is the basic operation that we use when contracting tensor networks.

When fusing three particles $a,b,c$ together, there is an ambiguity as to whether
we fuse $a,b$ first and then $c$, or fuse $a$ with the fusion of $b,c$. The difference
is the intermediate quantum number, here denoted $e$ or $f$. The difference between
these forms of fusion is given by the $F$ symbol.
\begin{equation}
\begin{gathered}
\includesvg[width=2cm]{fusion4left}
\end{gathered}
= \sum_f \fsymbol{a}{b}{c}{d}{e}{f}
\begin{gathered}
\includesvg[width=2cm]{fusion4right}
\end{gathered}
\end{equation}
Alternatively, we can write, in Bonderson's notation.
\begin{equation}
\ket{a,b;e} \ket{e,c;d} = \sum_f  \fsymbol{a}{b}{c}{d}{e}{f} \ket{b,c;f} \ket{a,f;d}
\end{equation}
Or as
\begin{equation}
\ket{((abe)c)d} = \sum_f \fsymbol{a}{b}{c}{d}{e}{f} \ket{(a(bcf))d}
\end{equation}
or as
\begin{equation}
\fsymbol{j_1}{j_2}{j_3}{j}{j_{12}}{j_{23}} 
= \rbraket{(j_1 j_2 j_{12}) j_3 j}{j_1 (j_2 j_3 j_{23}) j}
\end{equation}
For given exterior legs $a,b,c,d$ we can view the F-symbol as the basis transformation
that maps between two different choices of internal labelling.

Note that the left-right ordering of spins $a,b,c,d$ is important here. This is
essentially a normal ordering of particles (or operators). We haven't said anything so far
about how we re-order particles. The F-symbols have some symmetries under interchange of
charges, but that isn't enough, by itself, to determine particle statistics. For that, we need
the $R$ matrix, which is discussed below.

Treating $\fsymbol{a}{b}{c}{d}{e}{f}$ as a matrix with respect to $(e,f)$ charges, it is unitary:
\begin{equation}
\left[ \left(F^{abc}_{d}\right)^\dagger \right]_{fe} = 
\left[ \left(F^{abc}_{d}\right)^* \right]_{ef} = \left[ \left(F^{abc}_{d}\right)^{-1} \right]_{fe}
\end{equation}

Consistency of $F$-moves is given by the Pentagon relation, which we can express as
\begin{equation}
\fsymbol fcdegl \fsymbol ablefk = \sum_{h} \fsymbol abcgfg \fsymbol ahdegk \fsymbol bcdkhl
\end{equation}

We are now in a position to examine further the diagrams from \refeq{eq:TwistedTime}. Firstly, we
flip the arrows so that we are consistent with the direction of time. Now the bends in the curve look like
fusion and splitting of anyons $a$ and $\bar{a}$ to and from the vacuum,
\begin{equation}
\begin{gathered}
\includesvg[width=3cm]{twistedfusion}
\end{gathered}
= \fsymbol{a}{\bar{a}}{a}{a}{1}{1}
\begin{gathered}
\includesvg[width=3cm]{twistedfusionloop}
\end{gathered}
= d_a \: \fsymbol{a}{\bar{a}}{a}{a}{1}{1}
\begin{gathered}
\includesvg[width=1.5cm]{labeldown}
\end{gathered}
\label{eq:TwistedTimeLoop}
\end{equation}
The quantity $ d_a \: \fsymbol{a}{\bar{a}}{a}{a}{1}{1} = \chi_a$ is a non-trivial phase which
is known as the Frobenius-Schur indicator. For charges that are not self-dual, it is possible
to fix a gauge such that $\chi_a = 1$. However if $a$ is self-dual then $\chi_a = \pm 1$ is a
gauge-invariant quantity and we need to keep track of diagrams that bend in the fashion of \refeq{eq:TwistedTimeLoop}.
Up to rank 4, only two modular tensor categories have particles with Frobenius-Schur indicator -1,
namely the semion and the $\sigma$ particle in $(A_1, 2)$ (this has the same $S$-matrix as Ising 
anyons\cite{MTCClassification};
the same fusion rules have two different possible braid representations, with $\pm 1$ Frobenius-Schur indicator).
In $SU(2)$, half-integer spins also have $-1$ Frobenius-Schur indicator.
For STC, the Frobenius-Schur indicator determines whether the representation is orthogonal or symplectic.
It is essentially the same quantity as the $2j$ phase (see below). In \emph{most} cases where we
want to deform lines, it turns out that the phase factors cancel so we don't need to incorporate $\chi_a$, however
we should keep it in mind.

The $F$-symbol that we have used so far is known as a 3-1 symbol, since it represents the fusion (or splitting)
of 3 particles into 1. There is also a 2-2 $F$-move, which corresponds to the change in labelling
\begin{equation}
\begin{gathered}
\includesvg[width=2cm]{fusion22left}
\end{gathered}
= \sum_f \fsymboltt{a}{b}{c}{d}{e}{f}
\begin{gathered}
\includesvg[width=2cm]{fusion22right}
\end{gathered}
\end{equation}
Note it is important here that both $e$ and $f$ legs are pointing in the same direction.



\section{Symmetries of 6j symbols}


See Butler page 59

\section{Braiding}

\iffalse

\begin{equation}
\begin{gathered}
\includesvg[width=2cm]{fusionswap}
\end{gathered}
=
\begin{gathered}
\includesvg[width=2cm]{rmatrix}
\end{gathered}
= R^c_{ab}
\begin{gathered}
\includesvg[width=2cm]{fusion}
\end{gathered}
\end{equation}


\section{Irreducible Tensors}

Using the normalization convention of Beidenharn, we define
\beq
\bigbraket{j'm'}{T^{[k]}_M}{jm}
= \rbigbraket{j'}{\vektor{T}^{[k]}}{j} \; \qcg{j}{k}{j'}{m}{M}{m'}
\label{eq:ITensorDef}
\eeq
Using the orthogonality of the CG coefficients, this defines the
reduced matrix elements\footnote{That this factorization exists is
  precisely the celebrated Wigner-Eckart theorem.},
\beq
\rbigbraket{j'}{\vektor{T}^{[k]}}{j}
= \sum_{mM} \qcg{j}{k}{j'}{m}{M}{m'} \bigbraket{j'm'}{T^{[k]}_M}{jm}
\eeq
where $m'$ is arbitrary.  Alternatively,
we can sum over $m'$ and divide by $(2m'+1)$,
\beq
\rbigbraket{j'}{\vektor{T}^{[k]}}{j}
= \sum_{mMm'} \frac{1}{2j'+1} \qcg{j}{k}{j'}{m}{M}{m'} \bigbraket{j'm'}{T^{[k]}_M}{jm}
\eeq
This is a hint that this normalization of the reduced matrix elements
is not as symmetric as one might like; however
using this normalization the reduced and
full matrix elements of scalar operators coincide.  In particular,
the reduced matrix elements of the identity operator are
\beq
\rbigbraket{j'}{I}{j} = \delta_{j'j}
\eeq
and those of the angular momentum operator are
\beq
\rbigbraket{j'}{J}{j} = \sqrt{j(j+1)} \; \delta_{j'j}
\eeq
But the trace of a scalar operator needs to be normalized properly;
\beq
\Tr X = \sum_{j} (2j+1) \rbigbraket{j}{X}{j}
\eeq

The normalization used here
is \textit{not} equivalent to that of Edmonds,
who instead defines
\beq
\bigbraket{j'm'}{T^{[k]}_M}{jm}
= \rbigbraket{j'}{\vektor{T}^{[k]}}{j}_{\mbox{Edmonds}}
\; \frac{(-1)^{j-m}}{\sqrt{2k+1}} \qcg{j'}{j}{k}{m'}{-m}{M}
\eeq
This normalization is also used by Varshalovich \etal \cite{Varsh}, 
thus it is important to
distinguish properties that explicitly depend on the normalization choice
for the reduced matrix elements versus intrinsic properties.

\subsection{Tensor multiplication}

The coupling of two operators is just as for ordinary spins;
\beq
\left[ \itensor{S}{k_1} \times \itensor{T}{k_2} \right]^{[k]}
\eeq
which denotes the set of operators with components
\beq
\left[ \itensor{S}{k_1} \times \itensor{T}{k_2} \right]^{[k]}_{\mu}
=
\sum_{\mu_1 \mu_2} \qcg{k_1}{k_2}{k}{\mu_1}{\mu_2}{\mu}
\itensorcomp{S}{k_1}{\mu_1} \itensorcomp{T}{k_2}{\mu_2}
\eeq
Applying the Wigner-Eckart gives, after a few lines of algebra,
\beq
\begin{array}{c}
\rbigbraket{j'}{\left[ \itensor{S}{k_1} \times \itensor{T}{k_2} \right]^{[k]}}{j}
\\
= (-1)^{j+j'+k} \sum_{j''} \sqrt{(2j''+1)(2k+1)} \qsixj{j'}{k_1}{j''}{k_2}{j}{k}
\\ \times
\rbigbraket{j'}{\itensor{S}{k_1}}{j''}
\rbigbraket{j''}{\itensor{T}{k_2}}{j}
\end{array}
\label{eq:TensorProduct}
\eeq

Note that multiplication of a tensor operator by a \textit{scalar} is a special
case where $k_2 = 0$, and \refeq{eq:6jzero} implies the coupling coefficient is identically 1.


\appendix

\section{Coupling coefficients for $SU(2)$}

\subsection{Clebsch-Gordan coefficients}

We use the notation of Biedenharn:
\beq
\qcg{j_1}{j_2}{j_3}{m_1}{m_2}{m_3}
\eeq
For fixed $j_1$ and $j_2$, these coefficients form a unitary matrix
of dimension $(2j_1 +1)(2j_2+1)$, with rows labelled by
$m_1,m_2$ and columns labelled by $j,m$.
An explicit form is:
\beq
\begin{array}{rcl}
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}} & = & \delta_{m_1+m_2,m}
\vspace{0.2cm} \\ & & \times
\left[ \frac{\displaystyle (2j_{}+1)(j_{}+j_1-j_2)!(j_{}-j_1+j_2)!(j_1+j_2-j_{})!}
            {\displaystyle (j_{}+j_1+j_2+1)!}
\right]^{\frac{1}{2}} 
\vspace{0.2cm} \\ & & \times
\left[ \frac{\displaystyle (j+m)!(j-m!)}
            {\displaystyle (j_1+m_1)!(j_1-m_1)!(j_2+m_2)!(j_2-m_2)!}
\right]^{\frac{1}{2}}
\vspace{0.2cm} \\ & & \times
\displaystyle \sum_{\displaystyle s} 
\frac{\displaystyle (-1)^{j_2+m_2+s_{}} (j_2+j_{}+m_1+s_{})!(j_1-m_1+s_{})!}
{\displaystyle s_{}!(j_{}-j_1+j_2-s_{})!(j_{}+m_{}-s_{})!(j_1-j_2-m_{}+s_{})!} \; .
\end{array}
\eeq
Orthogonality of rows
\beq
\sum_{m_1 m_2} \qcg{j_1}{j_2}{j}{m_1}{m_2}{m} \qcg{j_1}{j_2}{j'}{m_1}{m_2}{m'}
= \delta_{jj'} \delta_{mm'}
\eeq
and orthogonality of columns
\beq
\sum_{jm} \qcg{j_1}{j_2}{j}{m_1}{m_2}{m} \qcg{j_1}{j_2}{j}{m'_1}{m'_2}{m}
= \delta_{m_1 m'_1} \delta_{m_2 m'_2}
\eeq

The `classical' symmetries form a group of order 12 
and until the work of Regge\cite{Regge}
it was believed that these exhausted the symmetries. 
The true symmetry group is of order 72.
The symmetry relations are (the group is generated by the first 4, the
remainder are for reference),
\beq
\begin{array}{rcl}
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}} 
& = & (-1)^{j_1+j_2-j} \qcg{j_1}{j_2}{j_{}}{-m_1,}{-m_2,}{-m_{}} \, , 
\vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}} 
& = & (-1)^{j_1+j_2-j} \qcg{j_2}{j_1}{j_{}}{m_2}{m_1}{m_{}} \, , 
\vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1,}{m_2,}{m_1+m_2} 
& = & \qcg{\frac{1}{2}(j_1+j_2+m_1+m_2)}{\frac{1}{2}(j_1+j_2-m_1-m_2)}{j_{}}
{\frac{1}{2}(j_1-j_2+m_1-m_2),}{\frac{1}{2}(j_1-j_2-m_1+m_2),}{j_1-j_2} \, , 
        \vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}}
& = & (-1)^{j_2+m_2} \sqrt{\frac{2j+1}{2j_1+1}} 
\qcg{j_{}}{j_2}{j_1}{-m_{},}{m_2,}{-m_1} \, , 
        \vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}}
& = & (-1)^{j_1-m_1} \sqrt{\frac{2j+1}{2j_2+1}} 
\qcg{j_1}{j_{}}{j_2}{m_1,}{-m_{},}{-m_2} \, , 
        \vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}}
& = & (-1)^{j_2+m_2} \sqrt{\frac{2j+1}{2j_1+1}} 
\qcg{j_2}{j_{}}{j_1}{-m_2,}{m_{},}{m_1} \, , 
        \vspace{0.2cm} \\
\qcg{j_1}{j_2}{j_{}}{m_1}{m_2}{m_{}}
& = & (-1)^{j_1-m_1} \sqrt{\frac{2j+1}{2j_2+1}} \qcg{j_{}}{j_1}{j_2}{m_{}}{-m_1}{m_2}
\end{array}
\eeq

A useful special case is
\beq
\qcg{j_1}{0}{j}{m_1}{0}{m} = \delta_{j_1 j} \delta_{m_1 m}
\label{eq:CG_SpecialCase}
\eeq


Alternate notation (Edmonds 1957):
\beq
\qcg{j_1}{j_2}{j}{m_1}{m_2}{m} \equiv
\braket{j_1 m_1 j_2 m_2}{j_1 j_2 j m}
\label{eq:EdmondsNotation}
\eeq

Alternate notation (Varshalovich \etal) \cite{Varsh}:
\beq
\qcg{j_1}{j_2}{j}{m_1}{m_2}{m} \equiv C^{jm}_{j_1 m_1 j_2 m_2}
\eeq

As is apparant from the phase factors and normalizations arising in
the symmetry relations, the Clebsch-Gordan coefficients have a mixed
symmetry. This is also clear from the notation \refeq{EdmondsNotation}
where $j_1$ and $j_2$ transform as bras, but $j$ transforms as a ket.
To see how this works, we can interpret the special
coefficient $\qcg{j'}{j}{0}{m'}{m}{0}$ as a metric tensor $\eta_{j'j}$, that
couples spins $j'$ and $j$ to a scalar. Here, $j'$ is the conjugate
spin to $j$. For $SU(2)$, we have numerically $j' = j$, but for
$U(1)$ we have $m' = -m$. In this form, the Clebsh-Gordan coefficient
has mixed symmetry $C_{j_1} {}_{j_1} {}^{j}$. This is convenient 
because \refeq{eq:EdmondsNotation} is usually exactly what we want,
but it is important to keep this detail in mind. The `symmetric'
version of the Clebsch-Gordan coefficient is the $3j$ coefficient
(an unfortunate name because it is a rather different object to the
$N-j$ coefficients for $N > 3$), and has the form
\beq
\qthreej{j_1}{j_2}{j}{m_1}{m_2}{m} = (-1)^{j+m+2j_1} \frac{1}{\sqrt{2j+1}}
\qcg{j_1}{j_2}{j}{-m_1}{-m_2}{m}
\eeq
The inverse form is
\beq
\qcg{j_1}{j_2}{j}{m_1}{m_2}{m} = (-1)^{j_1-j_2+m} \sqrt{2j+1}
\qthreej{j_1}{j_2}{j}{m_1}{m_2}{-m}
\eeq
The phase factors are chosen so that any cyclic permutation of columns leaves
the $3j$ symbol unchanged. Under an odd permutation of columns, the symbol
picks up a phase factor $(-1)^{j_1+j_2+j}$, which is the same phase factor
from the transformation $(m_1,m_2,m) \rightarrow (-m_1,-m_2,-m)$.

\subsection{$6j$ Symbols}

The simplest known explitit form is due to Racah\cite{Racah1,Racah2},
\beq
\begin{array}{c}
\multicolumn{1}{l}{
\qsixj{j_1}{j_2}{j_{}}{k_1}{k_2}{k_{}} =
\Delta(j_1j_2j_{})\Delta(k_1k_2j_{})\Delta(j_1k_2k_{})\Delta(k_1j_2k_{})}
\hfill \vspace{0.2cm} \\  \times
\displaystyle \sum_z \frac{\displaystyle (-1)^z (z+1)!}
            {\displaystyle (z_{}-j_1-j_2-j_{})!(z_{}-k_1-k_2-j_{})!
                           (z_{}-j_1-k_2-k_{})!(z_{}-k_1-j_2-k_{})!}
 \vspace{0.2cm} \\  \times
\frac{\displaystyle 1}
     {\displaystyle (j_1+j_2+k_1+k_2-z_{})!(j_1+k_1+j_{}+k_{}-z_{})!
(j_2+k_2+j_{}+k_{}-z_{})!} \, ,
\end{array}
\eeq
where $\Delta(abc)$ is the {\em triangle coefficient},
\beq
\Delta(abc) = \epsilon_{abc} \left[ 
  \frac{(a+b-c)!(a-b+c)!(-a+b+c)!}{(a+b+c+1)!} 
\right]^{\frac{1}{2}} \; .
\eeq
Here $\epsilon_{abc}$ enforces the {\em triangle condition},
\beq
\epsilon_{abc} = 
\begin{cases}
1, & \text{if $c \in \{|a-b|, |a-b|+1, \ldots, a+b \}$}  \\
0, & \text{otherwise}
\end{cases} 
\;.
\eeq
This is, despite the apparant asymmetry, in fact symmetric in all 
permutations of $a,b,c$.
The definition of the $6j$ symbols seems to be universal, with just one
common alternate, the Racah coefficient $W$, that differs by a simple
phase factor (note also the change in ordering of the indices),
\beq
W(j_1, j_2, j_5, j_4 ; j_3, j_6) =
\qsixj{j_1}{j_2}{j_3}{j_4}{j_5}{j_6} \; (-1)^{j_1+j_2+j_3+j_4}
\eeq

The $6j$ symbol is invariant under permutations of its columns, and
swapping the elements of \textit{two} columns.  \ie
\beq
\qsixj{j_1}{j_2}{j_3}{j_4}{j_5}{j_6}
= \qsixj{j_2}{j_1}{j_3}{j_5}{j_4}{j_6}
= \qsixj{j_1}{j_3}{j_2}{j_4}{j_6}{j_5}
= \qsixj{j_4}{j_5}{j_3}{j_1}{j_2}{j_6}
\eeq
and so on. The full symmetry group is bigger, 144 elements, but 
the remaining symmetries are not pure permutations. They also satisfy an orthogonality constraint,
\beq
\sum_{j_3} (2j_3+1) \qsixj{j_1}{j_2}{j_3}{j_4}{j_5}{j_6} \qsixj{j_1}{j_2}{j_3}{j_4}{j_5}{j'_6} 
= \frac{\delta_{j^{}_6 j'_6}}{2j_6+1}
\label{eq:6jortho}
\eeq
and a special case where one of the $j$'s is zero,
\beq
\qsixj{j_1}{j_2}{j_3}{j_4}{j_5}{0} = \delta_{j_2 j_4} \delta_{j_1 j_5} 
\frac{(-1)^{j_1+j-2+j_3}}{\sqrt{(2j_1+1)(2j_2+1)}} \; .
\label{eq:6jzero}
\eeq

The $6j$ symbol gives the recoupling of three angular momenta,
\beq
\begin{array}{c}
\braket{j_1 (j_2 j_3) j_{23} ; j'm'}{(j_1 j_2) j_{12} j_3 ; jm}
\\
 = \delta_{j'j} \delta_{m'm} (-1)^{j_1+j_2+j_3+j} \sqrt{(2j_{12}+1)(2j_{23}+1)}
\qsixj{j_1}{j_2}{j_{12}}{j_3}{j}{j_{23}}
\end{array}
\eeq

This is different to Eq. (2.121) in my thesis, I think the ordering of
the $j's$ in that equation is incorrect.

Alternative couplings:
\beq
\begin{array}{c}
\braket{(j_1 j_2) j_{12} j_3 ; j'm'}{(j_1 j_3) j_{13} j_2 ; jm}
\\
= \delta_{j'j} \delta_{m'm} (-1)^{j_2+j_3+j_{12}+j_{13}} \sqrt{(2j_{12}+1)(2j_{23}+1)}
\qsixj{j_2}{j_1}{j_{12}}{j_3}{j}{j_{13}}
\end{array}
\eeq
\beq
\begin{array}{c}
\braket{j_1 (j_2 j_3) j_{23} ; j'm'}{(j_1 j_3) j_{13} j_2 ; jm}
\\
= \delta_{j'j} \delta_{m'm} (-1)^{j_1+j_3+j_{23}} \sqrt{(2j_{13}+1)(2j_{23}+1)}
\qsixj{j_1}{j_3}{j_{13}}{j_3}{j}{j_{23}}
\end{array}
\eeq

This is simply a notation change from the recoupling of tensor operators,
\beq
\begin{array}{l}
  ((\itensor{P}{j_1} \times \itensor{Q}{j_2})^{[j_{12}]} \times
  \itensor{R}{j_3})^{[j]} = (-1)^{j_1+j_2+j_3+j} \sum_{j_{23}}
  \sqrt{(2j_{12}+1)(2j_{23}+1)} \\
  \quad \times
  \qsixj{j_1}{j_2}{j_{12}}{j_3}{j}{j_{23}} 
  (\itensor{P}{j_1} \times (\itensor{Q}{j_2} \times
  \itensor{R}{j_3})^{[j_{23}]})^{[j]}
\end{array}
\eeq
and so on.

For tensors that commute, there is a phase factor from the coupling;
\beq
(\itensor{P}{j_1} \times \itensor{Q}{j_2})^{[j]} = (-1)^{j_1+j_2-j}
(\itensor{Q}{j_2} \times \itensor{P}{j_1})^{[j]}
\label{eq:CommutationPhase}
\eeq

The definition of the $6j$ symbols in terms of the Clebsch-Gordan coefficients is
\beq
\begin{array}{c}
\displaystyle
\sum_{m m_i m_{ij}} \qcg{j_{12}}{j_3}{j}{m_{12}}{m_3}{m} 
\qcg{j_1}{j_2}{j_{12}}{m_1}{m_2}{m_{12}}
\qcg{j_1}{j_{23}}{j'}{m_1}{m_{23}}{m'} \qcg{j_2}{j_3}{j_{23}}{m_2}{m_3}{m_{23}}
\\
= \delta_{j'j} \delta_{m'm} (-1)^{j_1+j_2+j_3+j} \sqrt{(2j_{12}+1)(2j_{23}+1)}
\qsixj{j_1}{j_2}{j_{12}}{j_3}{j}{j_{23}}
\end{array}
\label{eq:SixJCG}
\eeq

When one argument is zero, the $6j$ coefficients reduce to a simple form,
\beq
\qsixj{a}{b}{c}{d}{e}{0} = (-1)^{a+b+c} 
\frac{\delta_{ae} \delta_{bd}}{\sqrt{(2a+1)(2b+1)}}
\eeq
The symmetry relations can be used to shift the zero to any position.
There are many formulas for other special cases listed in
Varshalovich \etal \cite{Varsh}.

\subsection{$9j$ Symbols}

A practical formula for evaluation of $9j$ coefficients is in terms of
a summation over $6j$ coeffecients:
\beq
\qninej{j_{11}}{j_{12}}{j_{13}}{j_{21}}{j_{22}}{j_{23}}{j_{31}}{j_{32}}{j_{33}}
= \sum_k (-1)^{2k} (2k+1) 
        \qsixj{j_{11}}{j_{21}}{j_{31}}{j_{32}}{j_{33}}{k_{}}
        \qsixj{j_{12}}{j_{22}}{j_{32}}{j_{21}}{k_{}}{j_{23}}
        \qsixj{j_{13}}{j_{23}}{j_{33}}{k_{}}{j_{11}}{j_{12}} \; .
\label{eq:NineJDefinition}
\eeq
From this, it can be shown that the $9j$ coefficient is zero unless the triangle 
conditions are fulfilled by the entries in each row and each column. There are
72 known symmetries of the $9j$ coefficent. The $9j$ coefficient is invarant
under even permutations of its rows, even permutation of its columns and
under interchange of rows and columns (transposition). It is multiplied by
a factor $(-1)^{\sum_{ik}j_{ik}}$ under an odd permutation of its rows or columns.

The $9j$ symbols are related to the recoupling of 4 angular momenta,
\beq
\begin{array}{c}
\braket{(j_1 j_2) j_{12} (j_3 j_4) j_{34} \; j'm'}{(j_1 j_3) j_{13} (j_2 j_4) j_{24} \; jm} 
\\
=
\delta_{jj'} \delta_{mm'}
\qninejsq{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
\end{array}
\eeq
where
\beq
\begin{array}{c}
\qninejsq{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
=
\\
\sqrt{(2j_{12}+1)(2j_{13}+1)(2j_{24}+1)(2j_{34}+1)}
\qninej{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
\end{array}
\eeq

As follows from the definition, a $9j$ symbol can also be expressed as
a sum of products of Clebsch-Gordan coefficients,
\beq
\begin{array}{c}
\displaystyle \sum_{m_i, m_{ik}}
\qcg{j_1}{j_2}{j_{12}}{m_1}{m_2}{m_{12}}
\qcg{j_3}{j_4}{j_{34}}{m_3}{m_4}{m_{34}}
\qcg{j_{12}}{j_{34}}{j}{m_{12}}{m_{34}}{m}
\qcg{j_1}{j_3}{j_{13}}{m_1}{m_3}{m_{13}}
\qcg{j_2}{j_4}{j_{24}}{m_2}{m_4}{m_{24}}
\qcg{j_{13}}{j_{24}}{j'}{m_{13}}{m_{24}}{m'}
\\
= \delta_{jj'} \delta_{mm'}
\qninejsq{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
\end{array}
\label{eq:NineJSqDef}
\eeq
If we sum over all of the $m$'s, then we get an additional factor $2j+1$ on the right hand side.

We will encounter this $[\cdots]$ symbol quite a lot, so it is worthwhile to examine a bit its symmetries.
From the symmetries of the $9j$ coefficient, the $[\cdots]$ is symmetric under transpose of all indices.
\beq
\qninejsq{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
=
\qninejsq{j_1}{j_3}{j_{13}}{j_2}{j_4}{j_{24}}{j_{12}}{j_{34}}{j}
\eeq

Under a swap of the first two rows or first two columns, it picks up a phase factor of $(-1)^{\sum j}$,
being the sum of all 9 quantum numbers. Hence it is invariant under the combined swap of the first two
rows and first two columns,
\beq
\qninejsq{j_1}{j_2}{j_{12}}{j_3}{j_4}{j_{34}}{j_{13}}{j_{24}}{j}
=
\qninejsq{j_4}{j_3}{j_{34}}{j_2}{j_1}{j_{12}}{j_{24}}{j_{13}}{j}
\eeq
Other symmetries are more complicated as they involve non-unitary prefactors.

\fi

\begin{thebibliography}{99}
\bibitem{Ardonne} \doi{10.1088/1751-8113/43/39/395205}
\bibitem{Bonderson} Parsa Bonderson, PhD thesis, CalTech 2007.  \url{http://thesis.library.caltech.edu/2447/}
\bibitem{MTC} M. M\"uger, Modular Categories. \arxiv{1201.6593}
\bibitem{MTCClassification} E. Rowell, R. Stong and Z. Wang, Commun. Math. Phys. 292, 343 (2009).
\arxiv{0712.1377}
\doi{10.1007/s00220-009-0908-z}
\bibitem{Pfeifer} Robert N. C. Pfeifer, Oliver Buerschaper, Simon Trebst, Andreas W. W. Ludwig, 
Matthias Troyer, and Guifre Vidal, Phys. Rev. B 86, 155111 (2012).
\arxiv{1005.5486}
\doi{10.1103/PhysRevB.86.155111}
\bibitem{AnyonDMRG} Robert N. C. Pfeifer and Sukhwinder Singh, Phys. Rev. B 92, 115135 (2015).
\doi{10.1103/PhysRevB.92.115135}

\end{thebibliography}

\end{document}
